# mdb 数据库 #

## 简介 ##

mdb 数据库是一个用于存储网络设备模型的数据库，它是下列部分组成：

- 一个底层数据库
- 一个上层orm
- 以及网络对象模型的定义

它要存储的数据有下列特点：

- 数据量小， 一般企业的网络规模也就是 200 台网络设备 + 50 台服务器， 每个设备建立模型后有500条数据（包括各种规则等），算下来大约是 125000 条数据， 超大型的网络如 10000 台网络设备 + 2500 服务器， 算下来大约是 6250000 条数据。事实上一般网络也就 100 - 500 台网络设备。
- 数据种类多， 网络设备种类繁多，每种设备的模型可能都有细微的不同，而服务器则更加复杂，有数据库，有Web服务器，有J2EE服务器， 每种服务器不厂商的又不一样。
- 对象之间的关系复杂，一个网络中各个设备的关系很自然的也是网状的，设备与设备之间的关系很重要也很复杂，建立好这种关系可以为智能网络管理打好基础。
- 查询多写请求少， 大部分数据都在第一次生成拓补图时存入数据库了，后期仅有少量的更改。而查间却是始终很多的。

从此两点可以看出关系型数据库不一定能适应此种需求，其中最大一个问题是不能很好地解决对象的继承，另一方面关系数据库的性能优势（即对大数据量的处理）体现不出来。当我们将眼光投向nosql时会发现图形数据库很适合，不幸地是现在很少有对图形数据库相关的使用案例。出于保险起见，底层数据库我使用了 mongodb， 原因是它能够很好地处理对象的继承。

在整个网络管理软件设计中我出于稳定性的目的，而采用了分进程的思路，这时 orm 层面临时一个选择， 即以库的形式提供或以一个中心式的服务提供，因为整个网络管理可能会用多个语言分别实现，这样只能有一个选择，那就是以一个中心式的服务提供。需要说明的是这个 orm 层不能算是一个标准的 orm， 它不追求通用性和灵活性，它仅专注于网络对象模型与底层数据库的映射。

网络对象模型就比较复杂，它会随着网络管理软件中的业务变化而变化，因此它应该有一个元模型来定义它，而不是由一份使用文档来描述。

1. 一个模型由一个类定义。
2. 一个类含有多个属性和多个约束组成
3. 一个属性由一个数据类型，一个名称和多个约束组成。
4. 类是可以继承的
5. 一个类可以关联另一个类， 其关系可以为 belongs_to/has_one/has_many/many_to_many/has_and_belongs_to_many 之一


## 使用方法 ##

请见 mdb_api.md
